{{- if .Values.database.enabled }}
# Database backup storage
apiVersion: objectstorage.giantswarm.io/v1alpha1
kind: Bucket
metadata:
  annotations:
    meta.helm.sh/release-name: {{ .Chart.Name }}
    meta.helm.sh/release-namespace: {{ .Release.Namespace }}
  labels:
    {{- include "labels.selector" . | nindent 4 }}
  name: giantswarm-{{ .Values.database.baseUrl }}-{{ .Chart.Name }}-{{ .Values.database.clusterName }}
  namespace: {{ .Release.Namespace }}
spec:
  name: giantswarm-{{ .Values.database.baseUrl }}-{{ .Chart.Name }}-{{ .Values.database.clusterName }}
  expirationPolicy:
    days: 100
  accessRole:
    roleName: giantswarm-{{ .Values.database.baseUrl }}-{{ .Chart.Name }}-{{ .Values.database.clusterName }}
    serviceAccountName: {{ .Chart.Name }}-{{ .Values.database.clusterName }}
    serviceAccountNamespace: {{ .Release.Namespace }}
  tags:
  - key: app
    value: {{ .Chart.Name }}
  - key: installation
    value: {{ .Values.database.baseUrl }}
  - key: name
    value: giantswarm-{{ .Values.database.baseUrl }}-{{ .Chart.Name }}-{{ .Values.database.clusterName }}
{{- end }}
